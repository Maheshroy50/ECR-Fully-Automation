{"format_version":"1.2","terraform_version":"1.5.7","variables":{"admin_jwt_secret":{"value":"x2+q0g85PQRugZUO6pGeLHPrYLLJkps6OhlYQIk+xTY="},"api_token_salt":{"value":"CCwVl/alr/rGrhEVXcmTkG45UO/c4l8mexoyWWr2YeI="},"app_keys":{"value":"97J2aB8fUF/ZQJD5DqYw9Q==,XAW6Pl8pFe/WF3tv1ZhGjw==,2SjBVutTyvp28Zaxx5OYpg==,8aog7PkeQhse3w5HGKqBOA=="},"db_password":{"value":"axPHdrMDon66qeEz"},"image_tag":{"value":"latest"},"jwt_secret":{"value":"A2AOIZyRo7fqPtyvte7KgjWL4iUE3Zv5ivrkKn6YtKw="},"project_name":{"value":"strapi-prod"},"region":{"value":"us-east-1"}},"planned_values":{"outputs":{"alb_dns_name":{"sensitive":false},"ecr_repository_url":{"sensitive":false,"type":"string","value":"811738710312.dkr.ecr.us-east-1.amazonaws.com/strapi-fargate-app"},"rds_endpoint":{"sensitive":false}},"root_module":{"resources":[{"address":"aws_eip.nat","mode":"managed","type":"aws_eip","name":"nat","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"address":null,"associate_with_private_ip":null,"customer_owned_ipv4_pool":null,"domain":"vpc","tags":{"Name":"strapi-prod-nat-eip"},"tags_all":{"Name":"strapi-prod-nat-eip"},"timeouts":null},"sensitive_values":{"tags":{},"tags_all":{}}},{"address":"aws_nat_gateway.main","mode":"managed","type":"aws_nat_gateway","name":"main","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"connectivity_type":"public","secondary_allocation_ids":null,"subnet_id":"subnet-0cc23dc8400d81bf3","tags":{"Name":"strapi-prod-nat-gw"},"tags_all":{"Name":"strapi-prod-nat-gw"},"timeouts":null},"sensitive_values":{"secondary_private_ip_addresses":[],"tags":{},"tags_all":{}}},{"address":"aws_route_table.private","mode":"managed","type":"aws_route_table","name":"private","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"route":[{"carrier_gateway_id":"","cidr_block":"0.0.0.0/0","core_network_arn":"","destination_prefix_list_id":"","egress_only_gateway_id":"","gateway_id":"","ipv6_cidr_block":"","local_gateway_id":"","network_interface_id":"","transit_gateway_id":"","vpc_endpoint_id":"","vpc_peering_connection_id":""}],"tags":{"Name":"strapi-prod-private-rt"},"tags_all":{"Name":"strapi-prod-private-rt"},"timeouts":null,"vpc_id":"vpc-0778ad9a2069279fc"},"sensitive_values":{"propagating_vgws":[],"route":[{}],"tags":{},"tags_all":{}}},{"address":"aws_route_table_association.private_1","mode":"managed","type":"aws_route_table_association","name":"private_1","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"gateway_id":null,"timeouts":null},"sensitive_values":{}},{"address":"aws_route_table_association.private_2","mode":"managed","type":"aws_route_table_association","name":"private_2","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"gateway_id":null,"timeouts":null},"sensitive_values":{}},{"address":"aws_security_group.alb_sg","mode":"managed","type":"aws_security_group","name":"alb_sg","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"description":"Allow HTTP inbound traffic","egress":[{"cidr_blocks":["0.0.0.0/0"],"description":"","from_port":0,"ipv6_cidr_blocks":[],"prefix_list_ids":[],"protocol":"-1","security_groups":[],"self":false,"to_port":0}],"ingress":[{"cidr_blocks":["0.0.0.0/0"],"description":"HTTP from anywhere","from_port":80,"ipv6_cidr_blocks":[],"prefix_list_ids":[],"protocol":"tcp","security_groups":[],"self":false,"to_port":80},{"cidr_blocks":["0.0.0.0/0"],"description":"HTTPS from anywhere","from_port":443,"ipv6_cidr_blocks":[],"prefix_list_ids":[],"protocol":"tcp","security_groups":[],"self":false,"to_port":443}],"name":"strapi-prod-alb-sg","revoke_rules_on_delete":false,"tags":null,"timeouts":null,"vpc_id":"vpc-0778ad9a2069279fc"},"sensitive_values":{"egress":[{"cidr_blocks":[false],"ipv6_cidr_blocks":[],"prefix_list_ids":[],"security_groups":[]}],"ingress":[{"cidr_blocks":[false],"ipv6_cidr_blocks":[],"prefix_list_ids":[],"security_groups":[]},{"cidr_blocks":[false],"ipv6_cidr_blocks":[],"prefix_list_ids":[],"security_groups":[]}],"tags_all":{}}},{"address":"aws_security_group.ecs_sg","mode":"managed","type":"aws_security_group","name":"ecs_sg","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"description":"Allow traffic from ALB","egress":[{"cidr_blocks":["0.0.0.0/0"],"description":"","from_port":0,"ipv6_cidr_blocks":[],"prefix_list_ids":[],"protocol":"-1","security_groups":[],"self":false,"to_port":0}],"ingress":[{"cidr_blocks":[],"description":"HTTP from ALB","from_port":1337,"ipv6_cidr_blocks":[],"prefix_list_ids":[],"protocol":"tcp","self":false,"to_port":1337}],"name":"strapi-prod-ecs-sg","revoke_rules_on_delete":false,"tags":null,"timeouts":null,"vpc_id":"vpc-0778ad9a2069279fc"},"sensitive_values":{"egress":[{"cidr_blocks":[false],"ipv6_cidr_blocks":[],"prefix_list_ids":[],"security_groups":[]}],"ingress":[{"cidr_blocks":[],"ipv6_cidr_blocks":[],"prefix_list_ids":[],"security_groups":[]}],"tags_all":{}}},{"address":"aws_security_group.rds_sg","mode":"managed","type":"aws_security_group","name":"rds_sg","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"description":"Allow PostgreSQL from ECS","egress":[{"cidr_blocks":["0.0.0.0/0"],"description":"","from_port":0,"ipv6_cidr_blocks":[],"prefix_list_ids":[],"protocol":"-1","security_groups":[],"self":false,"to_port":0}],"ingress":[{"cidr_blocks":[],"description":"PostgreSQL from ECS","from_port":5432,"ipv6_cidr_blocks":[],"prefix_list_ids":[],"protocol":"tcp","self":false,"to_port":5432}],"name":"strapi-prod-rds-sg","revoke_rules_on_delete":false,"tags":null,"timeouts":null,"vpc_id":"vpc-0778ad9a2069279fc"},"sensitive_values":{"egress":[{"cidr_blocks":[false],"ipv6_cidr_blocks":[],"prefix_list_ids":[],"security_groups":[]}],"ingress":[{"cidr_blocks":[],"ipv6_cidr_blocks":[],"prefix_list_ids":[],"security_groups":[]}],"tags_all":{}}},{"address":"aws_subnet.private_1","mode":"managed","type":"aws_subnet","name":"private_1","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"assign_ipv6_address_on_creation":false,"availability_zone":"us-east-1a","cidr_block":"172.31.200.0/24","customer_owned_ipv4_pool":null,"enable_dns64":false,"enable_lni_at_device_index":null,"enable_resource_name_dns_a_record_on_launch":false,"enable_resource_name_dns_aaaa_record_on_launch":false,"ipv6_cidr_block":null,"ipv6_native":false,"map_customer_owned_ip_on_launch":null,"map_public_ip_on_launch":false,"outpost_arn":null,"tags":{"Name":"strapi-prod-private-subnet-1"},"tags_all":{"Name":"strapi-prod-private-subnet-1"},"timeouts":null,"vpc_id":"vpc-0778ad9a2069279fc"},"sensitive_values":{"tags":{},"tags_all":{}}},{"address":"aws_subnet.private_2","mode":"managed","type":"aws_subnet","name":"private_2","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"assign_ipv6_address_on_creation":false,"availability_zone":"us-east-1b","cidr_block":"172.31.201.0/24","customer_owned_ipv4_pool":null,"enable_dns64":false,"enable_lni_at_device_index":null,"enable_resource_name_dns_a_record_on_launch":false,"enable_resource_name_dns_aaaa_record_on_launch":false,"ipv6_cidr_block":null,"ipv6_native":false,"map_customer_owned_ip_on_launch":null,"map_public_ip_on_launch":false,"outpost_arn":null,"tags":{"Name":"strapi-prod-private-subnet-2"},"tags_all":{"Name":"strapi-prod-private-subnet-2"},"timeouts":null,"vpc_id":"vpc-0778ad9a2069279fc"},"sensitive_values":{"tags":{},"tags_all":{}}}],"child_modules":[{"resources":[{"address":"module.alb.aws_lb.main","mode":"managed","type":"aws_lb","name":"main","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"access_logs":[],"client_keep_alive":3600,"connection_logs":[],"customer_owned_ipv4_pool":null,"desync_mitigation_mode":"defensive","dns_record_client_routing_policy":null,"drop_invalid_header_fields":false,"enable_cross_zone_load_balancing":null,"enable_deletion_protection":false,"enable_http2":true,"enable_tls_version_and_cipher_suite_headers":false,"enable_waf_fail_open":false,"enable_xff_client_port":false,"enable_zonal_shift":false,"idle_timeout":60,"internal":false,"ipam_pools":[],"load_balancer_type":"application","minimum_load_balancer_capacity":[],"name":"strapi-prod-alb","preserve_host_header":false,"subnets":["subnet-00efaeabe6a244f6f","subnet-03328ca5b606c3a5f","subnet-06701128dccb18698","subnet-077310516cd53e746","subnet-07a818843e186c178","subnet-0cc23dc8400d81bf3"],"tags":{"Name":"strapi-prod-alb"},"tags_all":{"Name":"strapi-prod-alb"},"timeouts":null,"xff_header_processing_mode":"append"},"sensitive_values":{"access_logs":[],"connection_logs":[],"ipam_pools":[],"minimum_load_balancer_capacity":[],"security_groups":[],"subnet_mapping":[],"subnets":[false,false,false,false,false,false],"tags":{},"tags_all":{}}},{"address":"module.alb.aws_lb_listener.prod","mode":"managed","type":"aws_lb_listener","name":"prod","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"alpn_policy":null,"certificate_arn":null,"default_action":[{"authenticate_cognito":[],"authenticate_oidc":[],"fixed_response":[],"forward":[],"redirect":[],"type":"forward"}],"port":80,"protocol":"HTTP","tags":null,"timeouts":null},"sensitive_values":{"default_action":[{"authenticate_cognito":[],"authenticate_oidc":[],"fixed_response":[],"forward":[],"redirect":[]}],"mutual_authentication":[],"tags_all":{}}},{"address":"module.alb.aws_lb_listener.test","mode":"managed","type":"aws_lb_listener","name":"test","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"alpn_policy":null,"certificate_arn":null,"default_action":[{"authenticate_cognito":[],"authenticate_oidc":[],"fixed_response":[],"forward":[],"redirect":[],"type":"forward"}],"port":8080,"protocol":"HTTP","tags":null,"timeouts":null},"sensitive_values":{"default_action":[{"authenticate_cognito":[],"authenticate_oidc":[],"fixed_response":[],"forward":[],"redirect":[]}],"mutual_authentication":[],"tags_all":{}}},{"address":"module.alb.aws_lb_target_group.blue","mode":"managed","type":"aws_lb_target_group","name":"blue","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"deregistration_delay":"300","health_check":[{"enabled":true,"healthy_threshold":2,"interval":30,"matcher":"200-399","path":"/","port":"traffic-port","protocol":"HTTP","timeout":5,"unhealthy_threshold":2}],"lambda_multi_value_headers_enabled":false,"name":"strapi-prod-tg-blue","port":1337,"protocol":"HTTP","proxy_protocol_v2":false,"slow_start":0,"tags":{"Name":"strapi-prod-tg-blue"},"tags_all":{"Name":"strapi-prod-tg-blue"},"target_type":"ip","vpc_id":"vpc-0778ad9a2069279fc"},"sensitive_values":{"health_check":[{}],"load_balancer_arns":[],"stickiness":[],"tags":{},"tags_all":{},"target_failover":[],"target_group_health":[],"target_health_state":[]}},{"address":"module.alb.aws_lb_target_group.green","mode":"managed","type":"aws_lb_target_group","name":"green","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"deregistration_delay":"300","health_check":[{"enabled":true,"healthy_threshold":2,"interval":30,"matcher":"200-399","path":"/","port":"traffic-port","protocol":"HTTP","timeout":5,"unhealthy_threshold":2}],"lambda_multi_value_headers_enabled":false,"name":"strapi-prod-tg-green","port":1337,"protocol":"HTTP","proxy_protocol_v2":false,"slow_start":0,"tags":{"Name":"strapi-prod-tg-green"},"tags_all":{"Name":"strapi-prod-tg-green"},"target_type":"ip","vpc_id":"vpc-0778ad9a2069279fc"},"sensitive_values":{"health_check":[{}],"load_balancer_arns":[],"stickiness":[],"tags":{},"tags_all":{},"target_failover":[],"target_group_health":[],"target_health_state":[]}}],"address":"module.alb"},{"resources":[{"address":"module.ecs.aws_codedeploy_app.strapi","mode":"managed","type":"aws_codedeploy_app","name":"strapi","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"compute_platform":"ECS","name":"strapi-prod-codedeploy-app","tags":null},"sensitive_values":{"tags_all":{}}},{"address":"module.ecs.aws_codedeploy_deployment_group.strapi","mode":"managed","type":"aws_codedeploy_deployment_group","name":"strapi","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"alarm_configuration":[],"app_name":"strapi-prod-codedeploy-app","auto_rollback_configuration":[{"enabled":true,"events":["DEPLOYMENT_FAILURE"]}],"autoscaling_groups":null,"blue_green_deployment_config":[{"deployment_ready_option":[{"action_on_timeout":"CONTINUE_DEPLOYMENT","wait_time_in_minutes":null}],"terminate_blue_instances_on_deployment_success":[{"action":"TERMINATE","termination_wait_time_in_minutes":5}]}],"deployment_config_name":"CodeDeployDefault.ECSCanary10Percent5Minutes","deployment_group_name":"strapi-prod-codedeploy-group","deployment_style":[{"deployment_option":"WITH_TRAFFIC_CONTROL","deployment_type":"BLUE_GREEN"}],"ec2_tag_filter":[],"ec2_tag_set":[],"ecs_service":[{"cluster_name":"strapi-prod-cluster","service_name":"strapi-prod-service"}],"load_balancer_info":[{"elb_info":[],"target_group_info":[],"target_group_pair_info":[{"prod_traffic_route":[{}],"target_group":[{"name":"strapi-prod-tg-blue"},{"name":"strapi-prod-tg-green"}],"test_traffic_route":[{}]}]}],"on_premises_instance_tag_filter":[],"outdated_instances_strategy":"UPDATE","service_role_arn":"arn:aws:iam::811738710312:role/codedeploy_role","tags":null,"termination_hook_enabled":false,"trigger_configuration":[]},"sensitive_values":{"alarm_configuration":[],"auto_rollback_configuration":[{"events":[false]}],"blue_green_deployment_config":[{"deployment_ready_option":[{}],"green_fleet_provisioning_option":[],"terminate_blue_instances_on_deployment_success":[{}]}],"deployment_style":[{}],"ec2_tag_filter":[],"ec2_tag_set":[],"ecs_service":[{}],"load_balancer_info":[{"elb_info":[],"target_group_info":[],"target_group_pair_info":[{"prod_traffic_route":[{"listener_arns":[]}],"target_group":[{},{}],"test_traffic_route":[{"listener_arns":[]}]}]}],"on_premises_instance_tag_filter":[],"tags_all":{},"trigger_configuration":[]}},{"address":"module.ecs.aws_ecs_cluster.main","mode":"managed","type":"aws_ecs_cluster","name":"main","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"configuration":[],"name":"strapi-prod-cluster","service_connect_defaults":[],"tags":{"Name":"strapi-prod-cluster"},"tags_all":{"Name":"strapi-prod-cluster"}},"sensitive_values":{"configuration":[],"service_connect_defaults":[],"setting":[],"tags":{},"tags_all":{}}},{"address":"module.ecs.aws_ecs_cluster_capacity_providers.main","mode":"managed","type":"aws_ecs_cluster_capacity_providers","name":"main","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"capacity_providers":["FARGATE"],"cluster_name":"strapi-prod-cluster","default_capacity_provider_strategy":[{"base":1,"capacity_provider":"FARGATE","weight":1}]},"sensitive_values":{"capacity_providers":[false],"default_capacity_provider_strategy":[{}]}},{"address":"module.ecs.aws_ecs_service.strapi","mode":"managed","type":"aws_ecs_service","name":"strapi","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"alarms":[],"availability_zone_rebalancing":"DISABLED","capacity_provider_strategy":[{"base":1,"capacity_provider":"FARGATE","weight":1}],"deployment_circuit_breaker":[],"deployment_controller":[{"type":"CODE_DEPLOY"}],"deployment_maximum_percent":200,"deployment_minimum_healthy_percent":100,"desired_count":1,"enable_ecs_managed_tags":false,"enable_execute_command":false,"force_delete":null,"force_new_deployment":null,"health_check_grace_period_seconds":null,"load_balancer":[{"container_name":"strapi","container_port":1337,"elb_name":""}],"name":"strapi-prod-service","network_configuration":[{"assign_public_ip":false}],"ordered_placement_strategy":[],"placement_constraints":[],"propagate_tags":null,"scheduling_strategy":"REPLICA","service_connect_configuration":[],"service_registries":[],"tags":null,"timeouts":null,"volume_configuration":[],"vpc_lattice_configurations":[],"wait_for_steady_state":false},"sensitive_values":{"alarms":[],"capacity_provider_strategy":[{}],"deployment_circuit_breaker":[],"deployment_controller":[{}],"load_balancer":[{}],"network_configuration":[{"security_groups":[],"subnets":[]}],"ordered_placement_strategy":[],"placement_constraints":[],"service_connect_configuration":[],"service_registries":[],"tags_all":{},"triggers":{},"volume_configuration":[],"vpc_lattice_configurations":[]}},{"address":"module.ecs.aws_ecs_task_definition.strapi","mode":"managed","type":"aws_ecs_task_definition","name":"strapi","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"cpu":"1024","ephemeral_storage":[],"execution_role_arn":"arn:aws:iam::811738710312:role/ecs_fargate_taskRole","family":"strapi-prod-task","inference_accelerator":[],"ipc_mode":null,"memory":"2048","network_mode":"awsvpc","pid_mode":null,"placement_constraints":[],"proxy_configuration":[],"requires_compatibilities":["FARGATE"],"runtime_platform":[],"skip_destroy":false,"tags":null,"task_role_arn":null,"track_latest":false,"volume":[]},"sensitive_values":{"container_definitions":true,"ephemeral_storage":[],"inference_accelerator":[],"placement_constraints":[],"proxy_configuration":[],"requires_compatibilities":[false],"runtime_platform":[],"tags_all":{},"volume":[]}}],"address":"module.ecs"},{"resources":[{"address":"module.rds.aws_db_instance.default","mode":"managed","type":"aws_db_instance","name":"default","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":2,"values":{"allocated_storage":20,"allow_major_version_upgrade":null,"apply_immediately":false,"auto_minor_version_upgrade":true,"blue_green_update":[],"copy_tags_to_snapshot":false,"custom_iam_instance_profile":null,"customer_owned_ip_enabled":null,"db_name":"strapi","db_subnet_group_name":"strapi-prod-db-subnet-group","dedicated_log_volume":false,"delete_automated_backups":true,"deletion_protection":null,"domain":null,"domain_auth_secret_arn":null,"domain_dns_ips":null,"domain_iam_role_name":null,"domain_ou":null,"enabled_cloudwatch_logs_exports":null,"engine":"postgres","engine_version":"14","final_snapshot_identifier":null,"iam_database_authentication_enabled":null,"identifier":"strapi-prod-db","instance_class":"db.t3.micro","manage_master_user_password":null,"max_allocated_storage":null,"monitoring_interval":0,"multi_az":false,"password":"axPHdrMDon66qeEz","password_wo":null,"password_wo_version":null,"performance_insights_enabled":false,"publicly_accessible":false,"replicate_source_db":null,"restore_to_point_in_time":[],"s3_import":[],"skip_final_snapshot":true,"storage_encrypted":null,"storage_type":"gp2","tags":{"Name":"strapi-prod-db"},"tags_all":{"Name":"strapi-prod-db"},"timeouts":null,"upgrade_storage_config":null,"username":"strapi"},"sensitive_values":{"blue_green_update":[],"listener_endpoint":[],"master_user_secret":[],"password":true,"replicas":[],"restore_to_point_in_time":[],"s3_import":[],"tags":{},"tags_all":{},"vpc_security_group_ids":[]}},{"address":"module.rds.aws_db_subnet_group.default","mode":"managed","type":"aws_db_subnet_group","name":"default","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"description":"Managed by Terraform","name":"strapi-prod-db-subnet-group","tags":{"Name":"strapi-prod-db-subnet-group"},"tags_all":{"Name":"strapi-prod-db-subnet-group"}},"sensitive_values":{"subnet_ids":[],"supported_network_types":[],"tags":{},"tags_all":{}}}],"address":"module.rds"}]}},"resource_changes":[{"address":"aws_eip.nat","mode":"managed","type":"aws_eip","name":"nat","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"address":null,"associate_with_private_ip":null,"customer_owned_ipv4_pool":null,"domain":"vpc","tags":{"Name":"strapi-prod-nat-eip"},"tags_all":{"Name":"strapi-prod-nat-eip"},"timeouts":null},"after_unknown":{"allocation_id":true,"arn":true,"association_id":true,"carrier_ip":true,"customer_owned_ip":true,"id":true,"instance":true,"ipam_pool_id":true,"network_border_group":true,"network_interface":true,"private_dns":true,"private_ip":true,"ptr_record":true,"public_dns":true,"public_ip":true,"public_ipv4_pool":true,"tags":{},"tags_all":{},"vpc":true},"before_sensitive":false,"after_sensitive":{"tags":{},"tags_all":{}}}},{"address":"aws_nat_gateway.main","mode":"managed","type":"aws_nat_gateway","name":"main","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"connectivity_type":"public","secondary_allocation_ids":null,"subnet_id":"subnet-0cc23dc8400d81bf3","tags":{"Name":"strapi-prod-nat-gw"},"tags_all":{"Name":"strapi-prod-nat-gw"},"timeouts":null},"after_unknown":{"allocation_id":true,"association_id":true,"id":true,"network_interface_id":true,"private_ip":true,"public_ip":true,"secondary_private_ip_address_count":true,"secondary_private_ip_addresses":true,"tags":{},"tags_all":{}},"before_sensitive":false,"after_sensitive":{"secondary_private_ip_addresses":[],"tags":{},"tags_all":{}}}},{"address":"aws_route_table.private","mode":"managed","type":"aws_route_table","name":"private","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"route":[{"carrier_gateway_id":"","cidr_block":"0.0.0.0/0","core_network_arn":"","destination_prefix_list_id":"","egress_only_gateway_id":"","gateway_id":"","ipv6_cidr_block":"","local_gateway_id":"","network_interface_id":"","transit_gateway_id":"","vpc_endpoint_id":"","vpc_peering_connection_id":""}],"tags":{"Name":"strapi-prod-private-rt"},"tags_all":{"Name":"strapi-prod-private-rt"},"timeouts":null,"vpc_id":"vpc-0778ad9a2069279fc"},"after_unknown":{"arn":true,"id":true,"owner_id":true,"propagating_vgws":true,"route":[{"nat_gateway_id":true}],"tags":{},"tags_all":{}},"before_sensitive":false,"after_sensitive":{"propagating_vgws":[],"route":[{}],"tags":{},"tags_all":{}}}},{"address":"aws_route_table_association.private_1","mode":"managed","type":"aws_route_table_association","name":"private_1","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"gateway_id":null,"timeouts":null},"after_unknown":{"id":true,"route_table_id":true,"subnet_id":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"aws_route_table_association.private_2","mode":"managed","type":"aws_route_table_association","name":"private_2","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"gateway_id":null,"timeouts":null},"after_unknown":{"id":true,"route_table_id":true,"subnet_id":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"aws_security_group.alb_sg","mode":"managed","type":"aws_security_group","name":"alb_sg","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"description":"Allow HTTP inbound traffic","egress":[{"cidr_blocks":["0.0.0.0/0"],"description":"","from_port":0,"ipv6_cidr_blocks":[],"prefix_list_ids":[],"protocol":"-1","security_groups":[],"self":false,"to_port":0}],"ingress":[{"cidr_blocks":["0.0.0.0/0"],"description":"HTTP from anywhere","from_port":80,"ipv6_cidr_blocks":[],"prefix_list_ids":[],"protocol":"tcp","security_groups":[],"self":false,"to_port":80},{"cidr_blocks":["0.0.0.0/0"],"description":"HTTPS from anywhere","from_port":443,"ipv6_cidr_blocks":[],"prefix_list_ids":[],"protocol":"tcp","security_groups":[],"self":false,"to_port":443}],"name":"strapi-prod-alb-sg","revoke_rules_on_delete":false,"tags":null,"timeouts":null,"vpc_id":"vpc-0778ad9a2069279fc"},"after_unknown":{"arn":true,"egress":[{"cidr_blocks":[false],"ipv6_cidr_blocks":[],"prefix_list_ids":[],"security_groups":[]}],"id":true,"ingress":[{"cidr_blocks":[false],"ipv6_cidr_blocks":[],"prefix_list_ids":[],"security_groups":[]},{"cidr_blocks":[false],"ipv6_cidr_blocks":[],"prefix_list_ids":[],"security_groups":[]}],"name_prefix":true,"owner_id":true,"tags_all":true},"before_sensitive":false,"after_sensitive":{"egress":[{"cidr_blocks":[false],"ipv6_cidr_blocks":[],"prefix_list_ids":[],"security_groups":[]}],"ingress":[{"cidr_blocks":[false],"ipv6_cidr_blocks":[],"prefix_list_ids":[],"security_groups":[]},{"cidr_blocks":[false],"ipv6_cidr_blocks":[],"prefix_list_ids":[],"security_groups":[]}],"tags_all":{}}}},{"address":"aws_security_group.ecs_sg","mode":"managed","type":"aws_security_group","name":"ecs_sg","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"description":"Allow traffic from ALB","egress":[{"cidr_blocks":["0.0.0.0/0"],"description":"","from_port":0,"ipv6_cidr_blocks":[],"prefix_list_ids":[],"protocol":"-1","security_groups":[],"self":false,"to_port":0}],"ingress":[{"cidr_blocks":[],"description":"HTTP from ALB","from_port":1337,"ipv6_cidr_blocks":[],"prefix_list_ids":[],"protocol":"tcp","self":false,"to_port":1337}],"name":"strapi-prod-ecs-sg","revoke_rules_on_delete":false,"tags":null,"timeouts":null,"vpc_id":"vpc-0778ad9a2069279fc"},"after_unknown":{"arn":true,"egress":[{"cidr_blocks":[false],"ipv6_cidr_blocks":[],"prefix_list_ids":[],"security_groups":[]}],"id":true,"ingress":[{"cidr_blocks":[],"ipv6_cidr_blocks":[],"prefix_list_ids":[],"security_groups":true}],"name_prefix":true,"owner_id":true,"tags_all":true},"before_sensitive":false,"after_sensitive":{"egress":[{"cidr_blocks":[false],"ipv6_cidr_blocks":[],"prefix_list_ids":[],"security_groups":[]}],"ingress":[{"cidr_blocks":[],"ipv6_cidr_blocks":[],"prefix_list_ids":[],"security_groups":[]}],"tags_all":{}}}},{"address":"aws_security_group.rds_sg","mode":"managed","type":"aws_security_group","name":"rds_sg","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"description":"Allow PostgreSQL from ECS","egress":[{"cidr_blocks":["0.0.0.0/0"],"description":"","from_port":0,"ipv6_cidr_blocks":[],"prefix_list_ids":[],"protocol":"-1","security_groups":[],"self":false,"to_port":0}],"ingress":[{"cidr_blocks":[],"description":"PostgreSQL from ECS","from_port":5432,"ipv6_cidr_blocks":[],"prefix_list_ids":[],"protocol":"tcp","self":false,"to_port":5432}],"name":"strapi-prod-rds-sg","revoke_rules_on_delete":false,"tags":null,"timeouts":null,"vpc_id":"vpc-0778ad9a2069279fc"},"after_unknown":{"arn":true,"egress":[{"cidr_blocks":[false],"ipv6_cidr_blocks":[],"prefix_list_ids":[],"security_groups":[]}],"id":true,"ingress":[{"cidr_blocks":[],"ipv6_cidr_blocks":[],"prefix_list_ids":[],"security_groups":true}],"name_prefix":true,"owner_id":true,"tags_all":true},"before_sensitive":false,"after_sensitive":{"egress":[{"cidr_blocks":[false],"ipv6_cidr_blocks":[],"prefix_list_ids":[],"security_groups":[]}],"ingress":[{"cidr_blocks":[],"ipv6_cidr_blocks":[],"prefix_list_ids":[],"security_groups":[]}],"tags_all":{}}}},{"address":"aws_subnet.private_1","mode":"managed","type":"aws_subnet","name":"private_1","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"assign_ipv6_address_on_creation":false,"availability_zone":"us-east-1a","cidr_block":"172.31.200.0/24","customer_owned_ipv4_pool":null,"enable_dns64":false,"enable_lni_at_device_index":null,"enable_resource_name_dns_a_record_on_launch":false,"enable_resource_name_dns_aaaa_record_on_launch":false,"ipv6_cidr_block":null,"ipv6_native":false,"map_customer_owned_ip_on_launch":null,"map_public_ip_on_launch":false,"outpost_arn":null,"tags":{"Name":"strapi-prod-private-subnet-1"},"tags_all":{"Name":"strapi-prod-private-subnet-1"},"timeouts":null,"vpc_id":"vpc-0778ad9a2069279fc"},"after_unknown":{"arn":true,"availability_zone_id":true,"id":true,"ipv6_cidr_block_association_id":true,"owner_id":true,"private_dns_hostname_type_on_launch":true,"tags":{},"tags_all":{}},"before_sensitive":false,"after_sensitive":{"tags":{},"tags_all":{}}}},{"address":"aws_subnet.private_2","mode":"managed","type":"aws_subnet","name":"private_2","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"assign_ipv6_address_on_creation":false,"availability_zone":"us-east-1b","cidr_block":"172.31.201.0/24","customer_owned_ipv4_pool":null,"enable_dns64":false,"enable_lni_at_device_index":null,"enable_resource_name_dns_a_record_on_launch":false,"enable_resource_name_dns_aaaa_record_on_launch":false,"ipv6_cidr_block":null,"ipv6_native":false,"map_customer_owned_ip_on_launch":null,"map_public_ip_on_launch":false,"outpost_arn":null,"tags":{"Name":"strapi-prod-private-subnet-2"},"tags_all":{"Name":"strapi-prod-private-subnet-2"},"timeouts":null,"vpc_id":"vpc-0778ad9a2069279fc"},"after_unknown":{"arn":true,"availability_zone_id":true,"id":true,"ipv6_cidr_block_association_id":true,"owner_id":true,"private_dns_hostname_type_on_launch":true,"tags":{},"tags_all":{}},"before_sensitive":false,"after_sensitive":{"tags":{},"tags_all":{}}}},{"address":"module.alb.aws_lb.main","module_address":"module.alb","mode":"managed","type":"aws_lb","name":"main","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"access_logs":[],"client_keep_alive":3600,"connection_logs":[],"customer_owned_ipv4_pool":null,"desync_mitigation_mode":"defensive","dns_record_client_routing_policy":null,"drop_invalid_header_fields":false,"enable_cross_zone_load_balancing":null,"enable_deletion_protection":false,"enable_http2":true,"enable_tls_version_and_cipher_suite_headers":false,"enable_waf_fail_open":false,"enable_xff_client_port":false,"enable_zonal_shift":false,"idle_timeout":60,"internal":false,"ipam_pools":[],"load_balancer_type":"application","minimum_load_balancer_capacity":[],"name":"strapi-prod-alb","preserve_host_header":false,"subnets":["subnet-00efaeabe6a244f6f","subnet-03328ca5b606c3a5f","subnet-06701128dccb18698","subnet-077310516cd53e746","subnet-07a818843e186c178","subnet-0cc23dc8400d81bf3"],"tags":{"Name":"strapi-prod-alb"},"tags_all":{"Name":"strapi-prod-alb"},"timeouts":null,"xff_header_processing_mode":"append"},"after_unknown":{"access_logs":[],"arn":true,"arn_suffix":true,"connection_logs":[],"dns_name":true,"enforce_security_group_inbound_rules_on_private_link_traffic":true,"id":true,"ip_address_type":true,"ipam_pools":[],"minimum_load_balancer_capacity":[],"name_prefix":true,"security_groups":true,"subnet_mapping":true,"subnets":[false,false,false,false,false,false],"tags":{},"tags_all":{},"vpc_id":true,"zone_id":true},"before_sensitive":false,"after_sensitive":{"access_logs":[],"connection_logs":[],"ipam_pools":[],"minimum_load_balancer_capacity":[],"security_groups":[],"subnet_mapping":[],"subnets":[false,false,false,false,false,false],"tags":{},"tags_all":{}}}},{"address":"module.alb.aws_lb_listener.prod","module_address":"module.alb","mode":"managed","type":"aws_lb_listener","name":"prod","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"alpn_policy":null,"certificate_arn":null,"default_action":[{"authenticate_cognito":[],"authenticate_oidc":[],"fixed_response":[],"forward":[],"redirect":[],"type":"forward"}],"port":80,"protocol":"HTTP","tags":null,"timeouts":null},"after_unknown":{"arn":true,"default_action":[{"authenticate_cognito":[],"authenticate_oidc":[],"fixed_response":[],"forward":[],"order":true,"redirect":[],"target_group_arn":true}],"id":true,"load_balancer_arn":true,"mutual_authentication":true,"routing_http_request_x_amzn_mtls_clientcert_header_name":true,"routing_http_request_x_amzn_mtls_clientcert_issuer_header_name":true,"routing_http_request_x_amzn_mtls_clientcert_leaf_header_name":true,"routing_http_request_x_amzn_mtls_clientcert_serial_number_header_name":true,"routing_http_request_x_amzn_mtls_clientcert_subject_header_name":true,"routing_http_request_x_amzn_mtls_clientcert_validity_header_name":true,"routing_http_request_x_amzn_tls_cipher_suite_header_name":true,"routing_http_request_x_amzn_tls_version_header_name":true,"routing_http_response_access_control_allow_credentials_header_value":true,"routing_http_response_access_control_allow_headers_header_value":true,"routing_http_response_access_control_allow_methods_header_value":true,"routing_http_response_access_control_allow_origin_header_value":true,"routing_http_response_access_control_expose_headers_header_value":true,"routing_http_response_access_control_max_age_header_value":true,"routing_http_response_content_security_policy_header_value":true,"routing_http_response_server_enabled":true,"routing_http_response_strict_transport_security_header_value":true,"routing_http_response_x_content_type_options_header_value":true,"routing_http_response_x_frame_options_header_value":true,"ssl_policy":true,"tags_all":true,"tcp_idle_timeout_seconds":true},"before_sensitive":false,"after_sensitive":{"default_action":[{"authenticate_cognito":[],"authenticate_oidc":[],"fixed_response":[],"forward":[],"redirect":[]}],"mutual_authentication":[],"tags_all":{}}}},{"address":"module.alb.aws_lb_listener.test","module_address":"module.alb","mode":"managed","type":"aws_lb_listener","name":"test","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"alpn_policy":null,"certificate_arn":null,"default_action":[{"authenticate_cognito":[],"authenticate_oidc":[],"fixed_response":[],"forward":[],"redirect":[],"type":"forward"}],"port":8080,"protocol":"HTTP","tags":null,"timeouts":null},"after_unknown":{"arn":true,"default_action":[{"authenticate_cognito":[],"authenticate_oidc":[],"fixed_response":[],"forward":[],"order":true,"redirect":[],"target_group_arn":true}],"id":true,"load_balancer_arn":true,"mutual_authentication":true,"routing_http_request_x_amzn_mtls_clientcert_header_name":true,"routing_http_request_x_amzn_mtls_clientcert_issuer_header_name":true,"routing_http_request_x_amzn_mtls_clientcert_leaf_header_name":true,"routing_http_request_x_amzn_mtls_clientcert_serial_number_header_name":true,"routing_http_request_x_amzn_mtls_clientcert_subject_header_name":true,"routing_http_request_x_amzn_mtls_clientcert_validity_header_name":true,"routing_http_request_x_amzn_tls_cipher_suite_header_name":true,"routing_http_request_x_amzn_tls_version_header_name":true,"routing_http_response_access_control_allow_credentials_header_value":true,"routing_http_response_access_control_allow_headers_header_value":true,"routing_http_response_access_control_allow_methods_header_value":true,"routing_http_response_access_control_allow_origin_header_value":true,"routing_http_response_access_control_expose_headers_header_value":true,"routing_http_response_access_control_max_age_header_value":true,"routing_http_response_content_security_policy_header_value":true,"routing_http_response_server_enabled":true,"routing_http_response_strict_transport_security_header_value":true,"routing_http_response_x_content_type_options_header_value":true,"routing_http_response_x_frame_options_header_value":true,"ssl_policy":true,"tags_all":true,"tcp_idle_timeout_seconds":true},"before_sensitive":false,"after_sensitive":{"default_action":[{"authenticate_cognito":[],"authenticate_oidc":[],"fixed_response":[],"forward":[],"redirect":[]}],"mutual_authentication":[],"tags_all":{}}}},{"address":"module.alb.aws_lb_target_group.blue","module_address":"module.alb","mode":"managed","type":"aws_lb_target_group","name":"blue","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"deregistration_delay":"300","health_check":[{"enabled":true,"healthy_threshold":2,"interval":30,"matcher":"200-399","path":"/","port":"traffic-port","protocol":"HTTP","timeout":5,"unhealthy_threshold":2}],"lambda_multi_value_headers_enabled":false,"name":"strapi-prod-tg-blue","port":1337,"protocol":"HTTP","proxy_protocol_v2":false,"slow_start":0,"tags":{"Name":"strapi-prod-tg-blue"},"tags_all":{"Name":"strapi-prod-tg-blue"},"target_type":"ip","vpc_id":"vpc-0778ad9a2069279fc"},"after_unknown":{"arn":true,"arn_suffix":true,"connection_termination":true,"health_check":[{}],"id":true,"ip_address_type":true,"load_balancer_arns":true,"load_balancing_algorithm_type":true,"load_balancing_anomaly_mitigation":true,"load_balancing_cross_zone_enabled":true,"name_prefix":true,"preserve_client_ip":true,"protocol_version":true,"stickiness":true,"tags":{},"tags_all":{},"target_failover":true,"target_group_health":true,"target_health_state":true},"before_sensitive":false,"after_sensitive":{"health_check":[{}],"load_balancer_arns":[],"stickiness":[],"tags":{},"tags_all":{},"target_failover":[],"target_group_health":[],"target_health_state":[]}}},{"address":"module.alb.aws_lb_target_group.green","module_address":"module.alb","mode":"managed","type":"aws_lb_target_group","name":"green","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"deregistration_delay":"300","health_check":[{"enabled":true,"healthy_threshold":2,"interval":30,"matcher":"200-399","path":"/","port":"traffic-port","protocol":"HTTP","timeout":5,"unhealthy_threshold":2}],"lambda_multi_value_headers_enabled":false,"name":"strapi-prod-tg-green","port":1337,"protocol":"HTTP","proxy_protocol_v2":false,"slow_start":0,"tags":{"Name":"strapi-prod-tg-green"},"tags_all":{"Name":"strapi-prod-tg-green"},"target_type":"ip","vpc_id":"vpc-0778ad9a2069279fc"},"after_unknown":{"arn":true,"arn_suffix":true,"connection_termination":true,"health_check":[{}],"id":true,"ip_address_type":true,"load_balancer_arns":true,"load_balancing_algorithm_type":true,"load_balancing_anomaly_mitigation":true,"load_balancing_cross_zone_enabled":true,"name_prefix":true,"preserve_client_ip":true,"protocol_version":true,"stickiness":true,"tags":{},"tags_all":{},"target_failover":true,"target_group_health":true,"target_health_state":true},"before_sensitive":false,"after_sensitive":{"health_check":[{}],"load_balancer_arns":[],"stickiness":[],"tags":{},"tags_all":{},"target_failover":[],"target_group_health":[],"target_health_state":[]}}},{"address":"module.ecs.aws_codedeploy_app.strapi","module_address":"module.ecs","mode":"managed","type":"aws_codedeploy_app","name":"strapi","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"compute_platform":"ECS","name":"strapi-prod-codedeploy-app","tags":null},"after_unknown":{"application_id":true,"arn":true,"github_account_name":true,"id":true,"linked_to_github":true,"tags_all":true},"before_sensitive":false,"after_sensitive":{"tags_all":{}}}},{"address":"module.ecs.aws_codedeploy_deployment_group.strapi","module_address":"module.ecs","mode":"managed","type":"aws_codedeploy_deployment_group","name":"strapi","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"alarm_configuration":[],"app_name":"strapi-prod-codedeploy-app","auto_rollback_configuration":[{"enabled":true,"events":["DEPLOYMENT_FAILURE"]}],"autoscaling_groups":null,"blue_green_deployment_config":[{"deployment_ready_option":[{"action_on_timeout":"CONTINUE_DEPLOYMENT","wait_time_in_minutes":null}],"terminate_blue_instances_on_deployment_success":[{"action":"TERMINATE","termination_wait_time_in_minutes":5}]}],"deployment_config_name":"CodeDeployDefault.ECSCanary10Percent5Minutes","deployment_group_name":"strapi-prod-codedeploy-group","deployment_style":[{"deployment_option":"WITH_TRAFFIC_CONTROL","deployment_type":"BLUE_GREEN"}],"ec2_tag_filter":[],"ec2_tag_set":[],"ecs_service":[{"cluster_name":"strapi-prod-cluster","service_name":"strapi-prod-service"}],"load_balancer_info":[{"elb_info":[],"target_group_info":[],"target_group_pair_info":[{"prod_traffic_route":[{}],"target_group":[{"name":"strapi-prod-tg-blue"},{"name":"strapi-prod-tg-green"}],"test_traffic_route":[{}]}]}],"on_premises_instance_tag_filter":[],"outdated_instances_strategy":"UPDATE","service_role_arn":"arn:aws:iam::811738710312:role/codedeploy_role","tags":null,"termination_hook_enabled":false,"trigger_configuration":[]},"after_unknown":{"alarm_configuration":[],"arn":true,"auto_rollback_configuration":[{"events":[false]}],"blue_green_deployment_config":[{"deployment_ready_option":[{}],"green_fleet_provisioning_option":true,"terminate_blue_instances_on_deployment_success":[{}]}],"compute_platform":true,"deployment_group_id":true,"deployment_style":[{}],"ec2_tag_filter":[],"ec2_tag_set":[],"ecs_service":[{}],"id":true,"load_balancer_info":[{"elb_info":[],"target_group_info":[],"target_group_pair_info":[{"prod_traffic_route":[{"listener_arns":true}],"target_group":[{},{}],"test_traffic_route":[{"listener_arns":true}]}]}],"on_premises_instance_tag_filter":[],"tags_all":true,"trigger_configuration":[]},"before_sensitive":false,"after_sensitive":{"alarm_configuration":[],"auto_rollback_configuration":[{"events":[false]}],"blue_green_deployment_config":[{"deployment_ready_option":[{}],"green_fleet_provisioning_option":[],"terminate_blue_instances_on_deployment_success":[{}]}],"deployment_style":[{}],"ec2_tag_filter":[],"ec2_tag_set":[],"ecs_service":[{}],"load_balancer_info":[{"elb_info":[],"target_group_info":[],"target_group_pair_info":[{"prod_traffic_route":[{"listener_arns":[]}],"target_group":[{},{}],"test_traffic_route":[{"listener_arns":[]}]}]}],"on_premises_instance_tag_filter":[],"tags_all":{},"trigger_configuration":[]}}},{"address":"module.ecs.aws_ecs_cluster.main","module_address":"module.ecs","mode":"managed","type":"aws_ecs_cluster","name":"main","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"configuration":[],"name":"strapi-prod-cluster","service_connect_defaults":[],"tags":{"Name":"strapi-prod-cluster"},"tags_all":{"Name":"strapi-prod-cluster"}},"after_unknown":{"arn":true,"configuration":[],"id":true,"service_connect_defaults":[],"setting":true,"tags":{},"tags_all":{}},"before_sensitive":false,"after_sensitive":{"configuration":[],"service_connect_defaults":[],"setting":[],"tags":{},"tags_all":{}}}},{"address":"module.ecs.aws_ecs_cluster_capacity_providers.main","module_address":"module.ecs","mode":"managed","type":"aws_ecs_cluster_capacity_providers","name":"main","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"capacity_providers":["FARGATE"],"cluster_name":"strapi-prod-cluster","default_capacity_provider_strategy":[{"base":1,"capacity_provider":"FARGATE","weight":1}]},"after_unknown":{"capacity_providers":[false],"default_capacity_provider_strategy":[{}],"id":true},"before_sensitive":false,"after_sensitive":{"capacity_providers":[false],"default_capacity_provider_strategy":[{}]}}},{"address":"module.ecs.aws_ecs_service.strapi","module_address":"module.ecs","mode":"managed","type":"aws_ecs_service","name":"strapi","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"alarms":[],"availability_zone_rebalancing":"DISABLED","capacity_provider_strategy":[{"base":1,"capacity_provider":"FARGATE","weight":1}],"deployment_circuit_breaker":[],"deployment_controller":[{"type":"CODE_DEPLOY"}],"deployment_maximum_percent":200,"deployment_minimum_healthy_percent":100,"desired_count":1,"enable_ecs_managed_tags":false,"enable_execute_command":false,"force_delete":null,"force_new_deployment":null,"health_check_grace_period_seconds":null,"load_balancer":[{"container_name":"strapi","container_port":1337,"elb_name":""}],"name":"strapi-prod-service","network_configuration":[{"assign_public_ip":false}],"ordered_placement_strategy":[],"placement_constraints":[],"propagate_tags":null,"scheduling_strategy":"REPLICA","service_connect_configuration":[],"service_registries":[],"tags":null,"timeouts":null,"volume_configuration":[],"vpc_lattice_configurations":[],"wait_for_steady_state":false},"after_unknown":{"alarms":[],"capacity_provider_strategy":[{}],"cluster":true,"deployment_circuit_breaker":[],"deployment_controller":[{}],"iam_role":true,"id":true,"launch_type":true,"load_balancer":[{"target_group_arn":true}],"network_configuration":[{"security_groups":true,"subnets":true}],"ordered_placement_strategy":[],"placement_constraints":[],"platform_version":true,"service_connect_configuration":[],"service_registries":[],"tags_all":true,"task_definition":true,"triggers":true,"volume_configuration":[],"vpc_lattice_configurations":[]},"before_sensitive":false,"after_sensitive":{"alarms":[],"capacity_provider_strategy":[{}],"deployment_circuit_breaker":[],"deployment_controller":[{}],"load_balancer":[{}],"network_configuration":[{"security_groups":[],"subnets":[]}],"ordered_placement_strategy":[],"placement_constraints":[],"service_connect_configuration":[],"service_registries":[],"tags_all":{},"triggers":{},"volume_configuration":[],"vpc_lattice_configurations":[]}}},{"address":"module.ecs.aws_ecs_task_definition.strapi","module_address":"module.ecs","mode":"managed","type":"aws_ecs_task_definition","name":"strapi","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"cpu":"1024","ephemeral_storage":[],"execution_role_arn":"arn:aws:iam::811738710312:role/ecs_fargate_taskRole","family":"strapi-prod-task","inference_accelerator":[],"ipc_mode":null,"memory":"2048","network_mode":"awsvpc","pid_mode":null,"placement_constraints":[],"proxy_configuration":[],"requires_compatibilities":["FARGATE"],"runtime_platform":[],"skip_destroy":false,"tags":null,"task_role_arn":null,"track_latest":false,"volume":[]},"after_unknown":{"arn":true,"arn_without_revision":true,"container_definitions":true,"enable_fault_injection":true,"ephemeral_storage":[],"id":true,"inference_accelerator":[],"placement_constraints":[],"proxy_configuration":[],"requires_compatibilities":[false],"revision":true,"runtime_platform":[],"tags_all":true,"volume":[]},"before_sensitive":false,"after_sensitive":{"container_definitions":true,"ephemeral_storage":[],"inference_accelerator":[],"placement_constraints":[],"proxy_configuration":[],"requires_compatibilities":[false],"runtime_platform":[],"tags_all":{},"volume":[]}}},{"address":"module.rds.aws_db_instance.default","module_address":"module.rds","mode":"managed","type":"aws_db_instance","name":"default","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"allocated_storage":20,"allow_major_version_upgrade":null,"apply_immediately":false,"auto_minor_version_upgrade":true,"blue_green_update":[],"copy_tags_to_snapshot":false,"custom_iam_instance_profile":null,"customer_owned_ip_enabled":null,"db_name":"strapi","db_subnet_group_name":"strapi-prod-db-subnet-group","dedicated_log_volume":false,"delete_automated_backups":true,"deletion_protection":null,"domain":null,"domain_auth_secret_arn":null,"domain_dns_ips":null,"domain_iam_role_name":null,"domain_ou":null,"enabled_cloudwatch_logs_exports":null,"engine":"postgres","engine_version":"14","final_snapshot_identifier":null,"iam_database_authentication_enabled":null,"identifier":"strapi-prod-db","instance_class":"db.t3.micro","manage_master_user_password":null,"max_allocated_storage":null,"monitoring_interval":0,"multi_az":false,"password":"axPHdrMDon66qeEz","password_wo":null,"password_wo_version":null,"performance_insights_enabled":false,"publicly_accessible":false,"replicate_source_db":null,"restore_to_point_in_time":[],"s3_import":[],"skip_final_snapshot":true,"storage_encrypted":null,"storage_type":"gp2","tags":{"Name":"strapi-prod-db"},"tags_all":{"Name":"strapi-prod-db"},"timeouts":null,"upgrade_storage_config":null,"username":"strapi"},"after_unknown":{"address":true,"arn":true,"availability_zone":true,"backup_retention_period":true,"backup_target":true,"backup_window":true,"blue_green_update":[],"ca_cert_identifier":true,"character_set_name":true,"database_insights_mode":true,"domain_fqdn":true,"endpoint":true,"engine_lifecycle_support":true,"engine_version_actual":true,"hosted_zone_id":true,"id":true,"identifier_prefix":true,"iops":true,"kms_key_id":true,"latest_restorable_time":true,"license_model":true,"listener_endpoint":true,"maintenance_window":true,"master_user_secret":true,"master_user_secret_kms_key_id":true,"monitoring_role_arn":true,"nchar_character_set_name":true,"network_type":true,"option_group_name":true,"parameter_group_name":true,"performance_insights_kms_key_id":true,"performance_insights_retention_period":true,"port":true,"replica_mode":true,"replicas":true,"resource_id":true,"restore_to_point_in_time":[],"s3_import":[],"snapshot_identifier":true,"status":true,"storage_throughput":true,"tags":{},"tags_all":{},"timezone":true,"vpc_security_group_ids":true},"before_sensitive":false,"after_sensitive":{"blue_green_update":[],"listener_endpoint":[],"master_user_secret":[],"password":true,"password_wo":true,"replicas":[],"restore_to_point_in_time":[],"s3_import":[],"tags":{},"tags_all":{},"vpc_security_group_ids":[]}}},{"address":"module.rds.aws_db_subnet_group.default","module_address":"module.rds","mode":"managed","type":"aws_db_subnet_group","name":"default","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"description":"Managed by Terraform","name":"strapi-prod-db-subnet-group","tags":{"Name":"strapi-prod-db-subnet-group"},"tags_all":{"Name":"strapi-prod-db-subnet-group"}},"after_unknown":{"arn":true,"id":true,"name_prefix":true,"subnet_ids":true,"supported_network_types":true,"tags":{},"tags_all":{},"vpc_id":true},"before_sensitive":false,"after_sensitive":{"subnet_ids":[],"supported_network_types":[],"tags":{},"tags_all":{}}}}],"output_changes":{"alb_dns_name":{"actions":["create"],"before":null,"after_unknown":true,"before_sensitive":false,"after_sensitive":false},"ecr_repository_url":{"actions":["create"],"before":null,"after":"811738710312.dkr.ecr.us-east-1.amazonaws.com/strapi-fargate-app","after_unknown":false,"before_sensitive":false,"after_sensitive":false},"rds_endpoint":{"actions":["create"],"before":null,"after_unknown":true,"before_sensitive":false,"after_sensitive":false}},"prior_state":{"format_version":"1.0","terraform_version":"1.5.7","values":{"outputs":{"ecr_repository_url":{"sensitive":false,"value":"811738710312.dkr.ecr.us-east-1.amazonaws.com/strapi-fargate-app","type":"string"}},"root_module":{"resources":[{"address":"data.aws_ecr_repository.strapi","mode":"data","type":"aws_ecr_repository","name":"strapi","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"arn":"arn:aws:ecr:us-east-1:811738710312:repository/strapi-fargate-app","encryption_configuration":[{"encryption_type":"AES256","kms_key":""}],"id":"strapi-fargate-app","image_scanning_configuration":[{"scan_on_push":true}],"image_tag_mutability":"MUTABLE","most_recent_image_tags":["05cf162af6ee00cac78c5fe0179746c7276da052"],"name":"strapi-fargate-app","registry_id":"811738710312","repository_url":"811738710312.dkr.ecr.us-east-1.amazonaws.com/strapi-fargate-app","tags":{}},"sensitive_values":{"encryption_configuration":[{}],"image_scanning_configuration":[{}],"most_recent_image_tags":[false],"tags":{}}},{"address":"data.aws_subnet.all[\"subnet-00efaeabe6a244f6f\"]","mode":"data","type":"aws_subnet","name":"all","index":"subnet-00efaeabe6a244f6f","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"arn":"arn:aws:ec2:us-east-1:811738710312:subnet/subnet-00efaeabe6a244f6f","assign_ipv6_address_on_creation":false,"availability_zone":"us-east-1b","availability_zone_id":"use1-az2","available_ip_address_count":4088,"cidr_block":"172.31.80.0/20","customer_owned_ipv4_pool":"","default_for_az":true,"enable_dns64":false,"enable_lni_at_device_index":0,"enable_resource_name_dns_a_record_on_launch":false,"enable_resource_name_dns_aaaa_record_on_launch":false,"filter":null,"id":"subnet-00efaeabe6a244f6f","ipv6_cidr_block":"","ipv6_cidr_block_association_id":"","ipv6_native":false,"map_customer_owned_ip_on_launch":false,"map_public_ip_on_launch":true,"outpost_arn":"","owner_id":"811738710312","private_dns_hostname_type_on_launch":"ip-name","state":"available","tags":{},"timeouts":null,"vpc_id":"vpc-0778ad9a2069279fc"},"sensitive_values":{"tags":{}}},{"address":"data.aws_subnet.all[\"subnet-03328ca5b606c3a5f\"]","mode":"data","type":"aws_subnet","name":"all","index":"subnet-03328ca5b606c3a5f","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"arn":"arn:aws:ec2:us-east-1:811738710312:subnet/subnet-03328ca5b606c3a5f","assign_ipv6_address_on_creation":false,"availability_zone":"us-east-1d","availability_zone_id":"use1-az6","available_ip_address_count":4087,"cidr_block":"172.31.32.0/20","customer_owned_ipv4_pool":"","default_for_az":true,"enable_dns64":false,"enable_lni_at_device_index":0,"enable_resource_name_dns_a_record_on_launch":false,"enable_resource_name_dns_aaaa_record_on_launch":false,"filter":null,"id":"subnet-03328ca5b606c3a5f","ipv6_cidr_block":"","ipv6_cidr_block_association_id":"","ipv6_native":false,"map_customer_owned_ip_on_launch":false,"map_public_ip_on_launch":true,"outpost_arn":"","owner_id":"811738710312","private_dns_hostname_type_on_launch":"ip-name","state":"available","tags":{},"timeouts":null,"vpc_id":"vpc-0778ad9a2069279fc"},"sensitive_values":{"tags":{}}},{"address":"data.aws_subnet.all[\"subnet-06701128dccb18698\"]","mode":"data","type":"aws_subnet","name":"all","index":"subnet-06701128dccb18698","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"arn":"arn:aws:ec2:us-east-1:811738710312:subnet/subnet-06701128dccb18698","assign_ipv6_address_on_creation":false,"availability_zone":"us-east-1e","availability_zone_id":"use1-az3","available_ip_address_count":4086,"cidr_block":"172.31.48.0/20","customer_owned_ipv4_pool":"","default_for_az":true,"enable_dns64":false,"enable_lni_at_device_index":0,"enable_resource_name_dns_a_record_on_launch":false,"enable_resource_name_dns_aaaa_record_on_launch":false,"filter":null,"id":"subnet-06701128dccb18698","ipv6_cidr_block":"","ipv6_cidr_block_association_id":"","ipv6_native":false,"map_customer_owned_ip_on_launch":false,"map_public_ip_on_launch":true,"outpost_arn":"","owner_id":"811738710312","private_dns_hostname_type_on_launch":"ip-name","state":"available","tags":{},"timeouts":null,"vpc_id":"vpc-0778ad9a2069279fc"},"sensitive_values":{"tags":{}}},{"address":"data.aws_subnet.all[\"subnet-077310516cd53e746\"]","mode":"data","type":"aws_subnet","name":"all","index":"subnet-077310516cd53e746","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"arn":"arn:aws:ec2:us-east-1:811738710312:subnet/subnet-077310516cd53e746","assign_ipv6_address_on_creation":false,"availability_zone":"us-east-1c","availability_zone_id":"use1-az4","available_ip_address_count":4088,"cidr_block":"172.31.16.0/20","customer_owned_ipv4_pool":"","default_for_az":true,"enable_dns64":false,"enable_lni_at_device_index":0,"enable_resource_name_dns_a_record_on_launch":false,"enable_resource_name_dns_aaaa_record_on_launch":false,"filter":null,"id":"subnet-077310516cd53e746","ipv6_cidr_block":"","ipv6_cidr_block_association_id":"","ipv6_native":false,"map_customer_owned_ip_on_launch":false,"map_public_ip_on_launch":true,"outpost_arn":"","owner_id":"811738710312","private_dns_hostname_type_on_launch":"ip-name","state":"available","tags":{},"timeouts":null,"vpc_id":"vpc-0778ad9a2069279fc"},"sensitive_values":{"tags":{}}},{"address":"data.aws_subnet.all[\"subnet-07a818843e186c178\"]","mode":"data","type":"aws_subnet","name":"all","index":"subnet-07a818843e186c178","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"arn":"arn:aws:ec2:us-east-1:811738710312:subnet/subnet-07a818843e186c178","assign_ipv6_address_on_creation":false,"availability_zone":"us-east-1f","availability_zone_id":"use1-az5","available_ip_address_count":4090,"cidr_block":"172.31.64.0/20","customer_owned_ipv4_pool":"","default_for_az":true,"enable_dns64":false,"enable_lni_at_device_index":0,"enable_resource_name_dns_a_record_on_launch":false,"enable_resource_name_dns_aaaa_record_on_launch":false,"filter":null,"id":"subnet-07a818843e186c178","ipv6_cidr_block":"","ipv6_cidr_block_association_id":"","ipv6_native":false,"map_customer_owned_ip_on_launch":false,"map_public_ip_on_launch":true,"outpost_arn":"","owner_id":"811738710312","private_dns_hostname_type_on_launch":"ip-name","state":"available","tags":{},"timeouts":null,"vpc_id":"vpc-0778ad9a2069279fc"},"sensitive_values":{"tags":{}}},{"address":"data.aws_subnet.all[\"subnet-0cc23dc8400d81bf3\"]","mode":"data","type":"aws_subnet","name":"all","index":"subnet-0cc23dc8400d81bf3","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"arn":"arn:aws:ec2:us-east-1:811738710312:subnet/subnet-0cc23dc8400d81bf3","assign_ipv6_address_on_creation":false,"availability_zone":"us-east-1a","availability_zone_id":"use1-az1","available_ip_address_count":4086,"cidr_block":"172.31.0.0/20","customer_owned_ipv4_pool":"","default_for_az":true,"enable_dns64":false,"enable_lni_at_device_index":0,"enable_resource_name_dns_a_record_on_launch":false,"enable_resource_name_dns_aaaa_record_on_launch":false,"filter":null,"id":"subnet-0cc23dc8400d81bf3","ipv6_cidr_block":"","ipv6_cidr_block_association_id":"","ipv6_native":false,"map_customer_owned_ip_on_launch":false,"map_public_ip_on_launch":true,"outpost_arn":"","owner_id":"811738710312","private_dns_hostname_type_on_launch":"ip-name","state":"available","tags":{},"timeouts":null,"vpc_id":"vpc-0778ad9a2069279fc"},"sensitive_values":{"tags":{}}},{"address":"data.aws_subnets.default","mode":"data","type":"aws_subnets","name":"default","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"filter":[{"name":"default-for-az","values":["true"]},{"name":"vpc-id","values":["vpc-0778ad9a2069279fc"]}],"id":"us-east-1","ids":["subnet-077310516cd53e746","subnet-03328ca5b606c3a5f","subnet-0cc23dc8400d81bf3","subnet-00efaeabe6a244f6f","subnet-07a818843e186c178","subnet-06701128dccb18698"],"tags":null,"timeouts":null},"sensitive_values":{"filter":[{"values":[false]},{"values":[false]}],"ids":[false,false,false,false,false,false]}},{"address":"data.aws_vpc.default","mode":"data","type":"aws_vpc","name":"default","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"arn":"arn:aws:ec2:us-east-1:811738710312:vpc/vpc-0778ad9a2069279fc","cidr_block":"172.31.0.0/16","cidr_block_associations":[{"association_id":"vpc-cidr-assoc-031bfe7dafb4332e3","cidr_block":"172.31.0.0/16","state":"associated"}],"default":true,"dhcp_options_id":"dopt-0cbadc8a208d4bdf8","enable_dns_hostnames":true,"enable_dns_support":true,"enable_network_address_usage_metrics":false,"filter":null,"id":"vpc-0778ad9a2069279fc","instance_tenancy":"default","ipv6_association_id":"","ipv6_cidr_block":"","main_route_table_id":"rtb-0b11d52e83ae5d2f8","owner_id":"811738710312","state":null,"tags":{},"timeouts":null},"sensitive_values":{"cidr_block_associations":[{}],"tags":{}}}]}}},"configuration":{"provider_config":{"aws":{"name":"aws","full_name":"registry.terraform.io/hashicorp/aws","version_constraint":"~\u003e 5.0","expressions":{"region":{"references":["var.region"]}}}},"root_module":{"outputs":{"alb_dns_name":{"expression":{"references":["module.alb.alb_dns_name","module.alb"]}},"ecr_repository_url":{"expression":{"references":["data.aws_ecr_repository.strapi.repository_url","data.aws_ecr_repository.strapi"]}},"rds_endpoint":{"expression":{"references":["module.rds.db_host","module.rds"]}}},"resources":[{"address":"aws_eip.nat","mode":"managed","type":"aws_eip","name":"nat","provider_config_key":"aws","expressions":{"domain":{"constant_value":"vpc"},"tags":{"references":["var.project_name"]}},"schema_version":0},{"address":"aws_nat_gateway.main","mode":"managed","type":"aws_nat_gateway","name":"main","provider_config_key":"aws","expressions":{"allocation_id":{"references":["aws_eip.nat.id","aws_eip.nat"]},"subnet_id":{"references":["local.public_subnets[0]","local.public_subnets"]},"tags":{"references":["var.project_name"]}},"schema_version":0,"depends_on":["aws_eip.nat"]},{"address":"aws_route_table.private","mode":"managed","type":"aws_route_table","name":"private","provider_config_key":"aws","expressions":{"route":{"references":["aws_nat_gateway.main.id","aws_nat_gateway.main"]},"tags":{"references":["var.project_name"]},"vpc_id":{"references":["data.aws_vpc.default.id","data.aws_vpc.default"]}},"schema_version":0},{"address":"aws_route_table_association.private_1","mode":"managed","type":"aws_route_table_association","name":"private_1","provider_config_key":"aws","expressions":{"route_table_id":{"references":["aws_route_table.private.id","aws_route_table.private"]},"subnet_id":{"references":["aws_subnet.private_1.id","aws_subnet.private_1"]}},"schema_version":0},{"address":"aws_route_table_association.private_2","mode":"managed","type":"aws_route_table_association","name":"private_2","provider_config_key":"aws","expressions":{"route_table_id":{"references":["aws_route_table.private.id","aws_route_table.private"]},"subnet_id":{"references":["aws_subnet.private_2.id","aws_subnet.private_2"]}},"schema_version":0},{"address":"aws_security_group.alb_sg","mode":"managed","type":"aws_security_group","name":"alb_sg","provider_config_key":"aws","expressions":{"description":{"constant_value":"Allow HTTP inbound traffic"},"egress":{"constant_value":[{"cidr_blocks":["0.0.0.0/0"],"description":null,"from_port":0,"ipv6_cidr_blocks":null,"prefix_list_ids":null,"protocol":"-1","security_groups":null,"self":null,"to_port":0}]},"ingress":{"constant_value":[{"cidr_blocks":["0.0.0.0/0"],"description":"HTTP from anywhere","from_port":80,"ipv6_cidr_blocks":null,"prefix_list_ids":null,"protocol":"tcp","security_groups":null,"self":null,"to_port":80},{"cidr_blocks":["0.0.0.0/0"],"description":"HTTPS from anywhere","from_port":443,"ipv6_cidr_blocks":null,"prefix_list_ids":null,"protocol":"tcp","security_groups":null,"self":null,"to_port":443}]},"name":{"references":["var.project_name"]},"vpc_id":{"references":["data.aws_vpc.default.id","data.aws_vpc.default"]}},"schema_version":1},{"address":"aws_security_group.ecs_sg","mode":"managed","type":"aws_security_group","name":"ecs_sg","provider_config_key":"aws","expressions":{"description":{"constant_value":"Allow traffic from ALB"},"egress":{"constant_value":[{"cidr_blocks":["0.0.0.0/0"],"description":null,"from_port":0,"ipv6_cidr_blocks":null,"prefix_list_ids":null,"protocol":"-1","security_groups":null,"self":null,"to_port":0}]},"ingress":{"references":["aws_security_group.alb_sg.id","aws_security_group.alb_sg"]},"name":{"references":["var.project_name"]},"vpc_id":{"references":["data.aws_vpc.default.id","data.aws_vpc.default"]}},"schema_version":1},{"address":"aws_security_group.rds_sg","mode":"managed","type":"aws_security_group","name":"rds_sg","provider_config_key":"aws","expressions":{"description":{"constant_value":"Allow PostgreSQL from ECS"},"egress":{"constant_value":[{"cidr_blocks":["0.0.0.0/0"],"description":null,"from_port":0,"ipv6_cidr_blocks":null,"prefix_list_ids":null,"protocol":"-1","security_groups":null,"self":null,"to_port":0}]},"ingress":{"references":["aws_security_group.ecs_sg.id","aws_security_group.ecs_sg"]},"name":{"references":["var.project_name"]},"vpc_id":{"references":["data.aws_vpc.default.id","data.aws_vpc.default"]}},"schema_version":1},{"address":"aws_subnet.private_1","mode":"managed","type":"aws_subnet","name":"private_1","provider_config_key":"aws","expressions":{"availability_zone":{"constant_value":"us-east-1a"},"cidr_block":{"constant_value":"172.31.200.0/24"},"tags":{"references":["var.project_name"]},"vpc_id":{"references":["data.aws_vpc.default.id","data.aws_vpc.default"]}},"schema_version":1},{"address":"aws_subnet.private_2","mode":"managed","type":"aws_subnet","name":"private_2","provider_config_key":"aws","expressions":{"availability_zone":{"constant_value":"us-east-1b"},"cidr_block":{"constant_value":"172.31.201.0/24"},"tags":{"references":["var.project_name"]},"vpc_id":{"references":["data.aws_vpc.default.id","data.aws_vpc.default"]}},"schema_version":1},{"address":"data.aws_ecr_repository.strapi","mode":"data","type":"aws_ecr_repository","name":"strapi","provider_config_key":"aws","expressions":{"name":{"constant_value":"strapi-fargate-app"}},"schema_version":0},{"address":"data.aws_subnet.all","mode":"data","type":"aws_subnet","name":"all","provider_config_key":"aws","expressions":{"id":{"references":["each.value"]}},"schema_version":0,"for_each_expression":{"references":["data.aws_subnets.default.ids","data.aws_subnets.default"]}},{"address":"data.aws_subnets.default","mode":"data","type":"aws_subnets","name":"default","provider_config_key":"aws","expressions":{"filter":[{"name":{"constant_value":"vpc-id"},"values":{"references":["data.aws_vpc.default.id","data.aws_vpc.default"]}},{"name":{"constant_value":"default-for-az"},"values":{"constant_value":["true"]}}]},"schema_version":0},{"address":"data.aws_vpc.default","mode":"data","type":"aws_vpc","name":"default","provider_config_key":"aws","expressions":{"default":{"constant_value":true}},"schema_version":0}],"module_calls":{"alb":{"source":"./modules/alb","expressions":{"alb_sg_id":{"references":["aws_security_group.alb_sg.id","aws_security_group.alb_sg"]},"project_name":{"references":["var.project_name"]},"public_subnets":{"references":["local.public_subnets"]},"vpc_id":{"references":["data.aws_vpc.default.id","data.aws_vpc.default"]}},"module":{"outputs":{"alb_dns_name":{"expression":{"references":["aws_lb.main.dns_name","aws_lb.main"]}},"listener_prod_arn":{"expression":{"references":["aws_lb_listener.prod.arn","aws_lb_listener.prod"]}},"listener_test_arn":{"expression":{"references":["aws_lb_listener.test.arn","aws_lb_listener.test"]}},"target_group_blue_arn":{"expression":{"references":["aws_lb_target_group.blue.arn","aws_lb_target_group.blue"]}},"target_group_blue_name":{"expression":{"references":["aws_lb_target_group.blue.name","aws_lb_target_group.blue"]}},"target_group_green_arn":{"expression":{"references":["aws_lb_target_group.green.arn","aws_lb_target_group.green"]}},"target_group_green_name":{"expression":{"references":["aws_lb_target_group.green.name","aws_lb_target_group.green"]}}},"resources":[{"address":"aws_lb.main","mode":"managed","type":"aws_lb","name":"main","provider_config_key":"aws","expressions":{"internal":{"constant_value":false},"load_balancer_type":{"constant_value":"application"},"name":{"references":["var.project_name"]},"security_groups":{"references":["var.alb_sg_id"]},"subnets":{"references":["var.public_subnets"]},"tags":{"references":["var.project_name"]}},"schema_version":0},{"address":"aws_lb_listener.prod","mode":"managed","type":"aws_lb_listener","name":"prod","provider_config_key":"aws","expressions":{"default_action":[{"target_group_arn":{"references":["aws_lb_target_group.blue.arn","aws_lb_target_group.blue"]},"type":{"constant_value":"forward"}}],"load_balancer_arn":{"references":["aws_lb.main.arn","aws_lb.main"]},"port":{"constant_value":"80"},"protocol":{"constant_value":"HTTP"}},"schema_version":0},{"address":"aws_lb_listener.test","mode":"managed","type":"aws_lb_listener","name":"test","provider_config_key":"aws","expressions":{"default_action":[{"target_group_arn":{"references":["aws_lb_target_group.green.arn","aws_lb_target_group.green"]},"type":{"constant_value":"forward"}}],"load_balancer_arn":{"references":["aws_lb.main.arn","aws_lb.main"]},"port":{"constant_value":"8080"},"protocol":{"constant_value":"HTTP"}},"schema_version":0},{"address":"aws_lb_target_group.blue","mode":"managed","type":"aws_lb_target_group","name":"blue","provider_config_key":"aws","expressions":{"health_check":[{"healthy_threshold":{"constant_value":2},"interval":{"constant_value":30},"matcher":{"constant_value":"200-399"},"path":{"constant_value":"/"},"timeout":{"constant_value":5},"unhealthy_threshold":{"constant_value":2}}],"name":{"references":["var.project_name"]},"port":{"constant_value":1337},"protocol":{"constant_value":"HTTP"},"tags":{"references":["var.project_name"]},"target_type":{"constant_value":"ip"},"vpc_id":{"references":["var.vpc_id"]}},"schema_version":0},{"address":"aws_lb_target_group.green","mode":"managed","type":"aws_lb_target_group","name":"green","provider_config_key":"aws","expressions":{"health_check":[{"healthy_threshold":{"constant_value":2},"interval":{"constant_value":30},"matcher":{"constant_value":"200-399"},"path":{"constant_value":"/"},"timeout":{"constant_value":5},"unhealthy_threshold":{"constant_value":2}}],"name":{"references":["var.project_name"]},"port":{"constant_value":1337},"protocol":{"constant_value":"HTTP"},"tags":{"references":["var.project_name"]},"target_type":{"constant_value":"ip"},"vpc_id":{"references":["var.vpc_id"]}},"schema_version":0}],"variables":{"alb_sg_id":{"description":"Security Group ID for ALB"},"project_name":{"description":"Project name"},"public_subnets":{"description":"List of public subnet IDs"},"vpc_id":{"description":"VPC ID"}}}},"ecs":{"source":"./modules/ecs","expressions":{"admin_jwt_secret":{"references":["var.admin_jwt_secret"]},"api_token_salt":{"references":["var.api_token_salt"]},"app_keys":{"references":["var.app_keys"]},"db_host":{"references":["module.rds.db_host","module.rds"]},"db_name":{"references":["module.rds.db_name","module.rds"]},"db_password":{"references":["var.db_password"]},"db_port":{"references":["module.rds.db_port","module.rds"]},"db_username":{"references":["module.rds.db_username","module.rds"]},"ecs_sg_id":{"references":["aws_security_group.ecs_sg.id","aws_security_group.ecs_sg"]},"image_tag":{"references":["var.image_tag"]},"image_url":{"references":["data.aws_ecr_repository.strapi.repository_url","data.aws_ecr_repository.strapi"]},"jwt_secret":{"references":["var.jwt_secret"]},"listener_prod_arn":{"references":["module.alb.listener_prod_arn","module.alb"]},"listener_test_arn":{"references":["module.alb.listener_test_arn","module.alb"]},"project_name":{"references":["var.project_name"]},"public_subnets":{"references":["aws_subnet.private_1.id","aws_subnet.private_1","aws_subnet.private_2.id","aws_subnet.private_2"]},"region":{"references":["var.region"]},"target_group_blue_arn":{"references":["module.alb.target_group_blue_arn","module.alb"]},"target_group_blue_name":{"references":["module.alb.target_group_blue_name","module.alb"]},"target_group_green_name":{"references":["module.alb.target_group_green_name","module.alb"]},"vpc_id":{"references":["data.aws_vpc.default.id","data.aws_vpc.default"]}},"module":{"outputs":{"cluster_name":{"expression":{"references":["aws_ecs_cluster.main.name","aws_ecs_cluster.main"]}},"service_name":{"expression":{"references":["aws_ecs_service.strapi.name","aws_ecs_service.strapi"]}}},"resources":[{"address":"aws_codedeploy_app.strapi","mode":"managed","type":"aws_codedeploy_app","name":"strapi","provider_config_key":"aws","expressions":{"compute_platform":{"constant_value":"ECS"},"name":{"references":["var.project_name"]}},"schema_version":0},{"address":"aws_codedeploy_deployment_group.strapi","mode":"managed","type":"aws_codedeploy_deployment_group","name":"strapi","provider_config_key":"aws","expressions":{"app_name":{"references":["aws_codedeploy_app.strapi.name","aws_codedeploy_app.strapi"]},"auto_rollback_configuration":[{"enabled":{"constant_value":true},"events":{"constant_value":["DEPLOYMENT_FAILURE"]}}],"blue_green_deployment_config":[{"deployment_ready_option":[{"action_on_timeout":{"constant_value":"CONTINUE_DEPLOYMENT"}}],"terminate_blue_instances_on_deployment_success":[{"action":{"constant_value":"TERMINATE"},"termination_wait_time_in_minutes":{"constant_value":5}}]}],"deployment_config_name":{"constant_value":"CodeDeployDefault.ECSCanary10Percent5Minutes"},"deployment_group_name":{"references":["var.project_name"]},"deployment_style":[{"deployment_option":{"constant_value":"WITH_TRAFFIC_CONTROL"},"deployment_type":{"constant_value":"BLUE_GREEN"}}],"ecs_service":[{"cluster_name":{"references":["aws_ecs_cluster.main.name","aws_ecs_cluster.main"]},"service_name":{"references":["aws_ecs_service.strapi.name","aws_ecs_service.strapi"]}}],"load_balancer_info":[{"target_group_pair_info":[{"prod_traffic_route":[{"listener_arns":{"references":["var.listener_prod_arn"]}}],"target_group":[{"name":{"references":["var.target_group_blue_name"]}},{"name":{"references":["var.target_group_green_name"]}}],"test_traffic_route":[{"listener_arns":{"references":["var.listener_test_arn"]}}]}]}],"service_role_arn":{"constant_value":"arn:aws:iam::811738710312:role/codedeploy_role"}},"schema_version":0},{"address":"aws_ecs_cluster.main","mode":"managed","type":"aws_ecs_cluster","name":"main","provider_config_key":"aws","expressions":{"name":{"references":["var.project_name"]},"tags":{"references":["var.project_name"]}},"schema_version":0},{"address":"aws_ecs_cluster_capacity_providers.main","mode":"managed","type":"aws_ecs_cluster_capacity_providers","name":"main","provider_config_key":"aws","expressions":{"capacity_providers":{"constant_value":["FARGATE"]},"cluster_name":{"references":["aws_ecs_cluster.main.name","aws_ecs_cluster.main"]},"default_capacity_provider_strategy":[{"base":{"constant_value":1},"capacity_provider":{"constant_value":"FARGATE"},"weight":{"constant_value":1}}]},"schema_version":0},{"address":"aws_ecs_service.strapi","mode":"managed","type":"aws_ecs_service","name":"strapi","provider_config_key":"aws","expressions":{"capacity_provider_strategy":[{"base":{"constant_value":1},"capacity_provider":{"constant_value":"FARGATE"},"weight":{"constant_value":1}}],"cluster":{"references":["aws_ecs_cluster.main.id","aws_ecs_cluster.main"]},"deployment_controller":[{"type":{"constant_value":"CODE_DEPLOY"}}],"desired_count":{"references":["var.desired_count"]},"load_balancer":[{"container_name":{"constant_value":"strapi"},"container_port":{"constant_value":1337},"target_group_arn":{"references":["var.target_group_blue_arn"]}}],"name":{"references":["var.project_name"]},"network_configuration":[{"assign_public_ip":{"constant_value":false},"security_groups":{"references":["var.ecs_sg_id"]},"subnets":{"references":["var.public_subnets"]}}],"task_definition":{"references":["aws_ecs_task_definition.strapi.arn","aws_ecs_task_definition.strapi"]}},"schema_version":1},{"address":"aws_ecs_task_definition.strapi","mode":"managed","type":"aws_ecs_task_definition","name":"strapi","provider_config_key":"aws","expressions":{"container_definitions":{"references":["var.image_url","var.image_tag","var.db_host","var.db_port","var.db_name","var.db_username","var.db_password","var.jwt_secret","var.admin_jwt_secret","var.app_keys","var.api_token_salt"]},"cpu":{"constant_value":1024},"execution_role_arn":{"constant_value":"arn:aws:iam::811738710312:role/ecs_fargate_taskRole"},"family":{"references":["var.project_name"]},"memory":{"constant_value":2048},"network_mode":{"constant_value":"awsvpc"},"requires_compatibilities":{"constant_value":["FARGATE"]}},"schema_version":1}],"variables":{"admin_jwt_secret":{"sensitive":true},"api_token_salt":{"sensitive":true},"app_keys":{"sensitive":true},"cpu":{"default":256,"description":"Fargate CPU"},"db_host":{},"db_name":{},"db_password":{"sensitive":true},"db_port":{},"db_username":{},"desired_count":{"default":1,"description":"Desired number of tasks"},"ecs_sg_id":{"description":"Security Group ID for ECS"},"image_tag":{"description":"Docker image tag"},"image_url":{"description":"Docker image URL (Repository URL)"},"jwt_secret":{"sensitive":true},"listener_prod_arn":{"description":"ALB Production Listener ARN"},"listener_test_arn":{"description":"ALB Test Listener ARN"},"memory":{"default":512,"description":"Fargate Memory"},"project_name":{"description":"Project name"},"public_subnets":{"description":"List of public subnet IDs"},"region":{"description":"AWS Region"},"target_group_blue_arn":{"description":"ALB Blue Target Group ARN"},"target_group_blue_name":{"description":"ALB Blue Target Group Name"},"target_group_green_name":{"description":"ALB Green Target Group Name"},"vpc_id":{"description":"VPC ID"}}}},"rds":{"source":"./modules/rds","expressions":{"db_password":{"references":["var.db_password"]},"private_subnets":{"references":["aws_subnet.private_1.id","aws_subnet.private_1","aws_subnet.private_2.id","aws_subnet.private_2"]},"project_name":{"references":["var.project_name"]},"rds_sg_id":{"references":["aws_security_group.rds_sg.id","aws_security_group.rds_sg"]}},"module":{"outputs":{"db_host":{"expression":{"references":["aws_db_instance.default.address","aws_db_instance.default"]}},"db_name":{"expression":{"references":["aws_db_instance.default.db_name","aws_db_instance.default"]}},"db_port":{"expression":{"references":["aws_db_instance.default.port","aws_db_instance.default"]}},"db_username":{"expression":{"references":["aws_db_instance.default.username","aws_db_instance.default"]}}},"resources":[{"address":"aws_db_instance.default","mode":"managed","type":"aws_db_instance","name":"default","provider_config_key":"aws","expressions":{"allocated_storage":{"constant_value":20},"db_name":{"constant_value":"strapi"},"db_subnet_group_name":{"references":["aws_db_subnet_group.default.name","aws_db_subnet_group.default"]},"engine":{"constant_value":"postgres"},"engine_version":{"constant_value":"14"},"identifier":{"references":["var.project_name"]},"instance_class":{"constant_value":"db.t3.micro"},"multi_az":{"constant_value":false},"password":{"references":["var.db_password"]},"publicly_accessible":{"constant_value":false},"skip_final_snapshot":{"constant_value":true},"storage_type":{"constant_value":"gp2"},"tags":{"references":["var.project_name"]},"username":{"constant_value":"strapi"},"vpc_security_group_ids":{"references":["var.rds_sg_id"]}},"schema_version":2},{"address":"aws_db_subnet_group.default","mode":"managed","type":"aws_db_subnet_group","name":"default","provider_config_key":"aws","expressions":{"name":{"references":["var.project_name"]},"subnet_ids":{"references":["var.private_subnets"]},"tags":{"references":["var.project_name"]}},"schema_version":0}],"variables":{"db_password":{"description":"Database password","sensitive":true},"private_subnets":{"description":"List of private subnet IDs"},"project_name":{"description":"Project name"},"rds_sg_id":{"description":"Security Group ID for RDS"}}}}},"variables":{"admin_jwt_secret":{"description":"Strapi Admin JWT Secret","sensitive":true},"api_token_salt":{"description":"Strapi API Token Salt","sensitive":true},"app_keys":{"description":"Strapi App Keys","sensitive":true},"db_password":{"description":"Database password","sensitive":true},"image_tag":{"default":"latest","description":"Docker image tag to deploy (e.g., git sha)"},"jwt_secret":{"description":"Strapi JWT Secret","sensitive":true},"project_name":{"default":"strapi-app","description":"Project name prefix"},"region":{"default":"us-east-1","description":"AWS Region"}}}},"relevant_attributes":[{"resource":"aws_nat_gateway.main","attribute":["id"]},{"resource":"module.rds.aws_db_instance.default","attribute":["db_name"]},{"resource":"module.alb.aws_lb_listener.prod","attribute":["arn"]},{"resource":"module.ecs.aws_ecs_cluster.main","attribute":["name"]},{"resource":"aws_security_group.ecs_sg","attribute":["id"]},{"resource":"module.ecs.aws_ecs_task_definition.strapi","attribute":["arn"]},{"resource":"aws_route_table.private","attribute":["id"]},{"resource":"module.ecs.aws_codedeploy_app.strapi","attribute":["name"]},{"resource":"module.rds.aws_db_instance.default","attribute":["port"]},{"resource":"aws_security_group.rds_sg","attribute":["id"]},{"resource":"data.aws_vpc.default","attribute":["id"]},{"resource":"module.rds.aws_db_subnet_group.default","attribute":["name"]},{"resource":"module.alb.aws_lb_target_group.green","attribute":["name"]},{"resource":"module.alb.aws_lb.main","attribute":["arn"]},{"resource":"module.alb.aws_lb.main","attribute":["dns_name"]},{"resource":"data.aws_subnets.default","attribute":["ids"]},{"resource":"aws_subnet.private_2","attribute":["id"]},{"resource":"module.alb.aws_lb_target_group.green","attribute":["arn"]},{"resource":"module.alb.aws_lb_target_group.blue","attribute":["arn"]},{"resource":"data.aws_subnet.all","attribute":[]},{"resource":"aws_security_group.alb_sg","attribute":["id"]},{"resource":"aws_subnet.private_1","attribute":["id"]},{"resource":"module.rds.aws_db_instance.default","attribute":["username"]},{"resource":"module.rds.aws_db_instance.default","attribute":["address"]},{"resource":"module.alb.aws_lb_listener.test","attribute":["arn"]},{"resource":"module.ecs.aws_ecs_cluster.main","attribute":["id"]},{"resource":"aws_eip.nat","attribute":["id"]},{"resource":"module.ecs.aws_ecs_service.strapi","attribute":["name"]},{"resource":"data.aws_ecr_repository.strapi","attribute":["repository_url"]},{"resource":"module.alb.aws_lb_target_group.blue","attribute":["name"]}],"timestamp":"2026-02-24T08:43:35Z"}
